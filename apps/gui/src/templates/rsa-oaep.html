<!DOCTYPE html>
<html lang="en">
<head>
  {% from '_background_effects.html' import background_layer, background_rules %}
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>{{ label }} - Details</title>
  <link rel="icon" href="/static/favicon.svg" type="image/svg+xml" sizes="any" />
  <link rel="mask-icon" href="/static/favicon.svg" color="#1fb6b8" />
  <link rel="apple-touch-icon" href="/static/Images/pqc-bench-logo.png" />
  <meta name="theme-color" content="#0b0f14" />
  <style>
    /* Dark scrollbar styling */
    html {
      scrollbar-width: thin;
      scrollbar-color: rgba(36, 49, 63, 0.85) rgba(7, 11, 17, 0.92);
    }
    html::-webkit-scrollbar {
      width: 12px;
      height: 12px;
    }
    html::-webkit-scrollbar-track {
      background: rgba(7, 11, 17, 0.92);
    }
    html::-webkit-scrollbar-thumb {
      background: rgba(148, 163, 184, 0.45);
      border-radius: 999px;
      border: 2px solid rgba(7, 11, 17, 0.92);
    }
    html::-webkit-scrollbar-thumb:hover {
      background: rgba(148, 163, 184, 0.65);
    }

  :root { --island-bg: rgba(38,41,45,.92); --island-radius:1.5rem; --text:#fff; --accent:#1fb6b8; }
    body {
      margin:0;
      padding:5vh 5vw;
      color:var(--text);
      font-family: Inter, system-ui, -apple-system, Segoe UI, Roboto, "Helvetica Neue", Arial, sans-serif;
      background:
        radial-gradient(circle at 15% 20%, rgba(31, 182, 184, 0.16), transparent 55%),
        radial-gradient(circle at 80% 15%, rgba(77, 157, 255, 0.12), transparent 60%),
        linear-gradient(180deg, #070b11 0%, #04070c 60%, #020408 100%);
      position: relative;
    }
    .island { background:var(--island-bg); border-radius:var(--island-radius); padding:1.25rem; backdrop-filter: blur(4px); max-width: 1000px; margin:0 auto 1.6vh auto; }
    .btn, button, input[type="submit"], input[type="button"], a.btn { padding:.65rem 1.4rem; border:none; border-radius:.7rem; background: var(--accent); color:#fff; cursor:pointer; box-shadow: 0 4px 14px rgba(31,182,184,.25); text-decoration:none; transition: background-color .2s ease, filter .15s ease, box-shadow .2s ease; }
    .btn:hover, button:hover, input[type="submit"]:hover, input[type="button"]:hover, a.btn:hover { filter: brightness(0.92); box-shadow: 0 6px 18px rgba(31,182,184,.32); }
    .badge { font-size:.9rem; background:rgba(255,255,255,.2); padding:.2rem .6rem; border-radius:.4rem; display:inline-block; }
    .muted { opacity:.9; }
    h2, h3 { margin: 0 0 .6rem 0; }
    h2 { font-size:1.25rem; }
    h3 { font-size:1.05rem; margin-top:1.2rem; }
    .grid-2 { display:grid; grid-template-columns:1fr 1fr; gap:1rem; }
    .mono { font-family: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono", "Courier New", monospace; }
    table { width:100%; border-collapse:collapse; }
    th, td { text-align:left; padding:.45rem .4rem; border-bottom:1px solid rgba(255,255,255,.2); }
    th { font-weight:600; }
    .refs li { margin:.35rem 0; }
    .chip { display:inline-block; font-size:.85rem; padding:.1rem .5rem; border-radius:.4rem; background:rgba(255,255,255,.15); margin-right:.4rem; }
    .toc a { color:#fff; text-decoration:none; }
    .toc a:hover { text-decoration:underline; }
    .note { font-size:.95rem; opacity:.95; }
    code { background: rgba(255,255,255,.12); padding:.05rem .3rem; border-radius:.3rem; }
    ol.refs { list-style: none; margin: 0; padding-left: 0; }
    ol.refs > li::marker { content: ""; }
    {{ background_rules() | safe }}
  </style>
  <!-- MathJax for LaTeX-style math -->
  <script async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
</head>
<body>
  {{ background_layer() }}
<div class="island" style="display:flex; justify-content:space-between; align-items:center; margin-bottom:2vh;">
    <div>
      <div style="font-size:1.6rem; font-weight:700;">{{ label }}</div>
      {% if kind %}<div class="badge" title="Kind">{{ kind }}</div>{% endif %}
    </div>
    <div>
      <a href="/" class="btn">Back to home</a>
    </div>
  </div>

  <div class="island">
    <div style="font-weight:700; margin-bottom:.5rem;">About</div>
    <p class="muted">
      {{ about or 'This page explains the RSA–OAEP encryption scheme in depth: its origins, math, parameters, algorithms, security assumptions, and implementation notes—plus references.' }}
    </p>
    <div class="toc muted">
      <span class="chip"><a href="#history">Origins & history</a></span>
      <span class="chip"><a href="#overview">Design overview</a></span>
      <span class="chip"><a href="#math">Mathematical setting</a></span>
      <span class="chip"><a href="#params">Parameter sets</a></span>
      <span class="chip"><a href="#algorithms">Algorithms</a></span>
      <span class="chip"><a href="#security">Security</a></span>
      <span class="chip"><a href="#impl">Implementation notes</a></span>
      <span class="chip"><a href="#proscons">Pros & cons</a></span>
      <span class="chip"><a href="#references">References</a></span>
    </div>
  </div>

  <div class="island" id="history">
    <h2>Origins & history</h2>
    <p class="muted">
      RSA (Rivest–Shamir–Adleman, 1977) is a trapdoor permutation over \(\mathbb{Z}_n^*\). <strong>OAEP</strong> (Optimal Asymmetric Encryption Padding)
      was proposed by Bellare–Rogaway (1994/95) to transform a trapdoor permutation into a probabilistic, semantically secure PKE in the Random Oracle Model (ROM) [2].
      Shoup (2001) revisited the proof for general TDPs [3]; subsequent results establish CCA2 security of RSA–OAEP under RSA-type assumptions in the ROM [4].
      PKCS #1 v2.2 (RFC 8017, 2016) specifies RSAES-OAEP precisely [1]; NIST SP 800-56B and SP 800-57 provide parameter guidance [5], [6].
    </p>
  </div>

  <div class="island" id="overview">
    <h2>Design overview</h2>
    <p class="muted">
      Naïve RSA is deterministic \(c=m^e\bmod n\), leaking equality and enabling malleability. OAEP wraps the message in a randomised
      encoding using two masks derived via MGF1 from a fresh seed and the data block [1], [2]. The resulting <em>encoded message</em> (EM) is
      then mapped to an integer and exponentiated. Correct decoding removes the masks and checks fixed headers, providing IND-CCA2
      security in the ROM when combined with RSA [2]–[4].
    </p>
  </div>

  <div class="island" id="math">
    <h2>Mathematical setting</h2>
    <div class="grid-2">
      <div>
        <h3>RSA keys</h3>
        <p class="muted">
          Choose primes \(p,q\); set \(n=pq\), \(\lambda(n)=\mathrm{lcm}(p-1,q-1)\). Pick \(e\) with \(\gcd(e,\lambda(n))=1\) (commonly \(65537\)),
          and compute \(d\equiv e^{-1}\pmod{\lambda(n)}\). Encryption/decryption:
        </p>
        <p class="mono">
          \( c \equiv m^{e}\ (\bmod\ n),\qquad m \equiv c^{d}\ (\bmod\ n). \)
        </p>
      </div>
      <div>
        <h3>OAEP components</h3>
        <p class="muted">
          Fix a hash \(H\) (output \(hLen\) bytes) and MGF1 (based on \(H\)). For label \(L\), set \(\mathtt{lHash}=H(L)\) [1].
        </p>
      </div>
    </div>

    <h3>EME-OAEP encoding</h3>
    <p class="muted">
      Let \(k\) be the modulus length in bytes and \(mLen=|M|\). Valid messages satisfy
    </p>
    <p class="mono">\( mLen \le k - 2\,hLen - 2 \) [1].</p>
    <ol class="muted">
      <li>Form \(\mathtt{DB}=\mathtt{lHash}\ \| \ \mathtt{PS}\ \|\ \texttt{0x01}\ \| \ M\), with \(\mathtt{PS}\) all-zero padding [1].</li>
      <li>Sample random seed \(S\in\{0,1\}^{8\,hLen}\) [1].</li>
      <li>\(\mathtt{maskedDB} = \mathtt{DB} \oplus \mathrm{MGF1}(S,\ k-hLen-1)\) [1].</li>
      <li>\(\mathtt{maskedSeed} = S \oplus \mathrm{MGF1}(\mathtt{maskedDB},\ hLen)\) [1].</li>
      <li>\(\mathtt{EM}=\texttt{0x00}\ \|\ \mathtt{maskedSeed}\ \|\ \mathtt{maskedDB}\) [1].</li>
    </ol>
    <p class="note">Decryption reverses masking, checks \(\mathtt{lHash}\) and the delimiter <code>0x01</code>, then parses \(M\) [1].</p>
  </div>

  <div class="island" id="params">
    <h2>Parameter sets</h2>
    <div class="grid-2">
      <div>
        <h3>Recommended choices</h3>
        <ul class="muted">
          <li>Hash \(H\): SHA-256 (or SHA-384/512 for higher strength) [1], [6].</li>
          <li>MGF: MGF1 using the <em>same</em> hash as \(H\) [1].</li>
          <li>Label \(L\): usually empty and fixed per key [1].</li>
          <li>Public exponent: \(e=65537\) [1].</li>
        </ul>
      </div>
      <div>
        <h3>Security-strength mapping (classical)</h3>
        <table>
          <thead><tr><th>Strength (≈)</th><th>Modulus</th><th>Typical hash</th></tr></thead>
          <tbody>
            <tr><td>112-bit</td><td>RSA-2048</td><td>SHA-224/256</td></tr>
            <tr><td>128-bit</td><td>RSA-3072</td><td>SHA-256/384</td></tr>
            <tr><td>192-bit</td><td>RSA-7680</td><td>SHA-384/512</td></tr>
            <tr><td>256-bit</td><td>RSA-15360</td><td>SHA-512</td></tr>
          </tbody>
        </table>
        <p class="note" style="margin-top:.5rem;">Per NIST SP 800-57 Part 1, Rev. 5 [6].</p>
      </div>
    </div>
    <p class="muted" style="margin-top:.5rem;">
      <b>Message size:</b> with modulus \(k\) bytes and hash \(hLen\) bytes, \(|M|\le k-2hLen-2\) (e.g., RSA-2048 with SHA-256 → 190 bytes) [1].
      In practice, RSA-OAEP encrypts a random session key for hybrid encryption [5].
    </p>
  </div>

  <div class="island" id="algorithms">
    <h2>Algorithms</h2>

    <h3>Key generation</h3>
    <p class="muted">
      Generate \(p,q\); compute \(n, \lambda(n), e, d\); store CRT values \(d_p, d_q, q^{-1}\bmod p\) for fast private ops [1].
    </p>

    <h3>Encryption (RSAES-OAEP)</h3>
    <ol class="muted">
      <li>Build \(\mathtt{EM}\leftarrow\mathrm{EME\mbox{-}OAEP\mbox{-}ENCODE}(M,L,H,\mathrm{MGF1})\) [1].</li>
      <li>Output \( C = \mathrm{I2OSP}\big(\mathrm{OS2IP}(\mathtt{EM})^e \bmod n,\ k\big) \) [1].</li>
    </ol>

    <h3>Decryption</h3>
    <ol class="muted">
      <li>Recover \(\hat{\mathtt{EM}}=\mathrm{I2OSP}(C^d\bmod n,\ k)\) [1].</li>
      <li>Parse and verify via \(\mathrm{EME\mbox{-}OAEP\mbox{-}DECODE}\); on any check failure, return a uniform error (constant-time) [1].</li>
    </ol>
  </div>

  <div class="island" id="security">
    <h2>Security at a glance</h2>
    <ul class="muted">
      <li><b>Goal:</b> IND-CCA2 in the ROM when combined with RSA [2]–[4].</li>
      <li><b>Assumptions:</b> RSA inversion hardness; \(H\) and MGF1 modeled as random oracles [2]–[4].</li>
      <li><b>Proof notes:</b> Padded encoding plus trapdoor permutation yields tight security for RSA-OAEP (RSA-specific refinements) [3], [4].</li>
      <li><b>Side-channels:</b> use RSA blinding, constant-time exponentiation/parsing, and CRT fault checks (re-encrypt and compare) [7]–[9].</li>
      <li><b>Quantum note:</b> RSA is vulnerable to Shor’s algorithm; prefer hybrid/PQ transitions for long-term confidentiality [6], [10].</li>
    </ul>
  </div>

  <div class="island" id="impl">
    <h2>Implementation notes</h2>
    <ul class="muted">
      <li>Fix \(H\), MGF1, and label \(L\) per key; don’t mix parameters with the same key [1].</li>
      <li>Use vetted libraries; enable CRT with verification; zeroise sensitive buffers [1], [8].</li>
      <li>Uniform error handling on decode; never surface padding-oracle differences [1].</li>
      <li>Use RSA-OAEP to wrap symmetric keys; use AEAD (AES-GCM/ChaCha20-Poly1305) for bulk data [5].</li>
    </ul>
  </div>

  <div class="island" id="proscons">
    <h2>Pros & cons</h2>
    <div class="grid-2">
      <div>
        <h3>Pros</h3>
        <ul class="muted">
          <li>Widely standardized/interoperable (RFC 8017; NIST guidance) [1], [5], [6].</li>
          <li>Provable CCA2 security in ROM with clear parameterisation [2]–[4].</li>
          <li>Excellent fit for hybrid key establishment [5].</li>
        </ul>
      </div>
      <div>
        <h3>Cons</h3>
        <ul class="muted">
          <li>Large keys/ciphertexts and slower private ops vs modern KEMs [5], [6].</li>
          <li>Implementation pitfalls (timing/oracles/faults) if countermeasures are absent [7]–[9].</li>
          <li>No post-quantum security [6], [10].</li>
        </ul>
      </div>
    </div>
  </div>

  <div class="island" id="references">
    <h2>References</h2>
    <ol class="refs muted">
  <li>[1] K. Moriarty, B. Kaliski, J. Jonsson, and A. Rusch, “<i>PKCS #1: RSA Cryptography Specifications Version 2.2</i>,” RFC 8017, Nov. 2016. Available: <a href="https://www.rfc-editor.org/rfc/rfc8017" target="_blank" rel="noopener">https://www.rfc-editor.org/info/rfc8017</a></li>

  <li>[2] M. Bellare and P. Rogaway, “Optimal Asymmetric Encryption: How to Encrypt with RSA,” in <i>EUROCRYPT ’94</i>, LNCS 950, 1995. Available: <a href="https://cseweb.ucsd.edu/~mihir/papers/oaep.pdf" target="_blank" rel="noopener">https://cseweb.ucsd.edu/~mihir/papers/oaep.pdf</a></li>

  <li>[3] V. Shoup, “OAEP Reconsidered,” in <i>CRYPTO 2001</i>, LNCS 2139, 2001. Available: <a href="https://shoup.net/papers/oaep.pdf" target="_blank" rel="noopener">https://shoup.net/papers/oaep.pdf</a></li>

  <li>[4] E. Fujisaki, T. Okamoto, D. Pointcheval, and J. Stern, “RSA–OAEP Is Secure under the RSA Assumption,” in <i>CRYPTO 2001</i>, 2001. Available: <a href="https://www.iacr.org/archive/crypto2001/21390259.pdf" target="_blank" rel="noopener">https://www.iacr.org/archive/crypto2001/21390259.pdf</a></li>

  <li>[5] E. Barker <i>et al.</i>, “<i>SP 800-56B Rev. 2: Recommendation for Pair-Wise Key-Establishment Using Integer Factorization Cryptography</i>,” NIST, Mar. 2019. DOI: <a href="https://doi.org/10.6028/NIST.SP.800-56Br2" target="_blank" rel="noopener">10.6028/NIST.SP.800-56Br2</a>. Available: <a href="https://doi.org/10.6028/NIST.SP.800-56Br2" target="_blank" rel="noopener">https://doi.org/10.6028/NIST.SP.800-56Br2</a></li>

  <li>[6] E. Barker, “<i>SP 800-57 Part 1 Rev. 5: Recommendation for Key Management</i>,” NIST, May 2020. DOI: <a href="https://doi.org/10.6028/NIST.SP.800-57pt1r5" target="_blank" rel="noopener">10.6028/NIST.SP.800-57pt1r5</a>. Available: <a href="https://doi.org/10.6028/NIST.SP.800-57pt1r5" target="_blank" rel="noopener">https://doi.org/10.6028/NIST.SP.800-57pt1r5</a></li>

  <li>[7] P. C. Kocher, “Timing Attacks on Implementations of Diffie-Hellman, RSA, DSS, and Others,” in <i>CRYPTO ’96</i>, 1996. Available: <a href="https://paulkocher.com/doc/TimingAttacks.pdf" target="_blank" rel="noopener">https://paulkocher.com/doc/TimingAttacks.pdf</a></li>

  <li>[8] D. Boneh, R. A. DeMillo, and R. J. Lipton, “On the Importance of Eliminating Errors in Cryptographic Computations,” <i>Journal of Cryptology</i>, vol. 14, pp. 101–119, 2001. DOI: <a href="https://doi.org/10.1007/s001450010003" target="_blank" rel="noopener">10.1007/s001450010003</a></li>

  <li>[9] É. Brier, D. Naccache, P.-A. Fouque, and Q. Nguyen, “Modulus Fault Attacks Against RSA-CRT Signatures,” in <i>CHES 2011</i>, 2011. DOI: <a href="https://doi.org/10.1007/978-3-642-23951-9_13" target="_blank" rel="noopener">10.1007/978-3-642-23951-9_13</a></li>

  <li>[10] E. Barker and A. Roginsky, “<i>SP 800-131A Rev. 2: Transitioning the Use of Cryptographic Algorithms and Key Lengths</i>,” NIST, 2019. DOI: <a href="https://doi.org/10.6028/NIST.SP.800-131Ar2" target="_blank" rel="noopener">10.6028/NIST.SP.800-131Ar2</a>. Available: <a href="https://doi.org/10.6028/NIST.SP.800-131Ar2" target="_blank" rel="noopener">https://doi.org/10.6028/NIST.SP.800-131Ar2</a></li>
</ol>

  </div>
</body>
</html>
