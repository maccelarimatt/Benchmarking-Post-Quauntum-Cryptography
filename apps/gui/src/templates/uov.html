<!DOCTYPE html>
<html lang="en">
<head>
  {% from '_background_effects.html' import background_layer, background_rules %}
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>{{ label }} - Details</title>
  <link rel="icon" href="/static/favicon.svg" type="image/svg+xml" sizes="any" />
  <link rel="mask-icon" href="/static/favicon.svg" color="#1fb6b8" />
  <link rel="apple-touch-icon" href="/static/Images/pqc-bench-logo.png" />
  <meta name="theme-color" content="#0b0f14" />
  <style>
    /* Dark scrollbar styling */
    html { scrollbar-width: thin; scrollbar-color: rgba(36,49,63,.85) rgba(7,11,17,.92); }
    html::-webkit-scrollbar { width:12px; height:12px; }
    html::-webkit-scrollbar-track { background: rgba(7,11,17,.92); }
    html::-webkit-scrollbar-thumb { background: rgba(148,163,184,.45); border-radius:999px; border:2px solid rgba(7,11,17,.92); }
    html::-webkit-scrollbar-thumb:hover { background: rgba(148,163,184,.65); }

    :root { --island-bg: rgba(38,41,45,.92); --island-radius:1.5rem; --text:#fff; --accent:#1fb6b8; }
    body {
      margin:0;
      padding:5vh 5vw;
      color:var(--text);
      font-family: Inter, system-ui, -apple-system, Segoe UI, Roboto, "Helvetica Neue", Arial, sans-serif;
      background:
        radial-gradient(circle at 15% 20%, rgba(31, 182, 184, 0.16), transparent 55%),
        radial-gradient(circle at 80% 15%, rgba(77, 157, 255, 0.12), transparent 60%),
        linear-gradient(180deg, #070b11 0%, #04070c 60%, #020408 100%);
      position: relative;
    }
    .island { background:var(--island-bg); border-radius:var(--island-radius); padding:1.25rem; backdrop-filter: blur(4px); max-width:1000px; margin:0 auto 1.6vh auto; }
    .btn, button, input[type="submit"], input[type="button"], a.btn { padding:.65rem 1.4rem; border:none; border-radius:.7rem; background: var(--accent); color:#fff; cursor:pointer; box-shadow:0 4px 14px rgba(31,182,184,.25); text-decoration:none; transition: background-color .2s ease, filter .15s ease, box-shadow .2s ease; }
    .btn:hover, button:hover, input[type="submit"]:hover, input[type="button"]:hover, a.btn:hover { filter:brightness(.92); box-shadow:0 6px 18px rgba(31,182,184,.32); }
    .badge { font-size:.9rem; background:rgba(255,255,255,.2); padding:.2rem .6rem; border-radius:.4rem; display:inline-block; }
    .muted { opacity:.9; }
    h2, h3 { margin:0 0 .6rem 0; }
    h2 { font-size:1.25rem; }
    h3 { font-size:1.05rem; margin-top:1.2rem; }
    .grid-2 { display:grid; grid-template-columns:1fr 1fr; gap:1rem; }
    .mono { font-family: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono", "Courier New", monospace; }
    table { width:100%; border-collapse:collapse; }
    th, td { text-align:left; padding:.45rem .4rem; border-bottom:1px solid rgba(255,255,255,.2); }
    th { font-weight:600; }
    .refs li { margin:.35rem 0; }
    .chip { display:inline-block; font-size:.85rem; padding:.1rem .5rem; border-radius:.4rem; background:rgba(255,255,255,.15); margin-right:.4rem; }
    .toc a { color:#fff; text-decoration:none; }
    .toc a:hover { text-decoration:underline; }
    .note { font-size:.95rem; opacity:.95; }
    code { background: rgba(255,255,255,.12); padding:.05rem .3rem; border-radius:.3rem; }
    ol.refs { list-style:none; margin:0; padding-left:0; }
    {{ background_rules() | safe }}
  </style>
  <!-- MathJax for LaTeX-style math -->
  <script async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
</head>
<body>
  {{ background_layer() }}
<div class="island" style="display:flex; justify-content:space-between; align-items:center; margin-bottom:2vh;">
    <div>
      <div style="font-size:1.6rem; font-weight:700;">{{ label }}</div>
      {% if kind %}<div class="badge" title="Kind">{{ kind }}</div>{% endif %}
    </div>
    <div><a href="/" class="btn">Back to home</a></div>
  </div>

  <div class="island">
    <div style="font-weight:700; margin-bottom:.5rem;">About</div>
    <p class="muted">
      {{ about or 'This page explains UOV (Unbalanced Oil and Vinegar) — a classic multivariate digital signature — including history, design, math, parameters, algorithms, security, and implementation notes.' }}
    </p>
    <div class="toc muted">
      <span class="chip"><a href="#history">Origins & history</a></span>
      <span class="chip"><a href="#overview">Design overview</a></span>
      <span class="chip"><a href="#math">Mathematical setting</a></span>
      <span class="chip"><a href="#params">Parameter sets</a></span>
      <span class="chip"><a href="#algorithms">Algorithms</a></span>
      <span class="chip"><a href="#security">Security</a></span>
      <span class="chip"><a href="#impl">Implementation notes</a></span>
      <span class="chip"><a href="#proscons">Pros & cons</a></span>
      <span class="chip"><a href="#references">References</a></span>
    </div>
  </div>

  <div class="island" id="history">
    <h2>Origins & history</h2>
    <p class="muted">
      <strong>UOV</strong> is a multivariate signature scheme introduced as a refinement of Patarin’s Oil-and-Vinegar (OaV) idea
      from the late 1990s. UOV “unbalances” variables into many vinegar and fewer oil variables so that, after fixing
      the vinegar variables, the remaining equations in the oil variables become <em>linear</em> and solvable efficiently.
      UOV has influenced numerous descendants (e.g., Rainbow) and remains a core design in the multivariate family.
    </p>
  </div>

  <div class="island" id="overview">
    <h2>Design overview</h2>
    <p class="muted">
      UOV publishes a system of quadratic polynomials \( P=(P_1,\ldots,P_m) \) in \( n=v+o \) variables over a small field
      \( \mathbb{F}_q \) (often \(q=2^8\)). The secret key consists of two affine maps \( S,T \) and a central map \( F \) with an
      Oil-and-Vinegar structure. To sign, choose the \(v\) vinegar variables uniformly, which turns each \(P_i\) into a
      <em>linear</em> equation in the \(o\) oil variables; solve the resulting linear system to obtain a preimage \( x \) such that
      \( P(x)=H(M) \) for message digest \(H(M)\). Verification recomputes \( P(x) \) and checks equality to the target digest.
    </p>
  </div>

  <div class="island" id="math">
    <h2>Mathematical setting</h2>
    <p class="muted">
      Let \( x=(x_1,\ldots,x_n) \) split as vinegar \( \mathbf{v}\in\mathbb{F}_q^v \) and oil \( \mathbf{o}\in\mathbb{F}_q^o \), \( n=v+o \).
      The public map is
    </p>
    <p class="mono">
      \( P = S \circ F \circ T : \mathbb{F}_q^n \to \mathbb{F}_q^m, \qquad m=o. \)
    </p>
    <p class="muted">
      In the central map \(F\), cross-terms only mix vinegar–oil and vinegar–vinegar variables (no oil–oil squares),
      so fixing \( \mathbf{v} \) yields a linear system in \( \mathbf{o} \):
    </p>
    <p class="mono">
      \( A(\mathbf{v})\,\mathbf{o} = b(\mathbf{v}) \in \mathbb{F}_q^{\,o}. \)
    </p>
    <p class="muted">
      If \(A(\mathbf{v})\) is invertible (which happens with high probability for well-chosen parameters), Gaussian elimination
      returns \( \mathbf{o} \), completing the preimage \(x=(\mathbf{v}\,\|\,\mathbf{o})\).
    </p>
  </div>

  <div class="island" id="params">
    <h2>Parameter sets (illustrative)</h2>
    <p class="muted note">
      UOV is a family of designs. Implementations typically work over \( \mathbb{F}_{2^8} \) and choose \( (v,o) \) to balance
      security vs. public-key size and performance. The table below shows <em>typical</em> styles (not a standard).
    </p>
    <div class="grid-2">
      <div>
        <table>
          <thead><tr><th>Target</th><th>\(q\)</th><th>\(v\)</th><th>\(o\)</th><th>\(n=v+o\)</th></tr></thead>
          <tbody>
            <tr><td>~128-bit</td><td>\(2^8\)</td><td>~100–160</td><td>~32–48</td><td>~132–208</td></tr>
            <tr><td>~192-bit</td><td>\(2^8\)</td><td>~160–220</td><td>~48–64</td><td>~208–284</td></tr>
            <tr><td>~256-bit</td><td>\(2^8\)</td><td>~220–300</td><td>~64–96</td><td>~284–396</td></tr>
          </tbody>
        </table>
        <p class="muted" style="margin-top:.5rem;">Exact choices depend on current cryptanalysis and desired margins.</p>
      </div>
      <div class="muted">
        <h3>Sizes (rules of thumb)</h3>
        <table>
          <thead><tr><th>Quantity</th><th>Order of magnitude</th><th>Notes</th></tr></thead>
          <tbody>
            <tr><td>Public key</td><td>100s KB → few MB</td><td>\(m=o\) quadratics in \(n\) vars, each with \(O(n^2)\) coeffs.</td></tr>
            <tr><td>Secret key</td><td>tens–hundreds KB</td><td>Affine maps \(S,T\) (or seeds if using compact/seeded forms).</td></tr>
            <tr><td>Signature</td><td>\(n\) bytes (for \(q{=}2^8\))</td><td>Vector \(x\in\mathbb{F}_{2^8}^n\); often ~150–400 B.</td></tr>
          </tbody>
        </table>
        <p class="muted" style="margin-top:.5rem;">Seeded/structured variants can reduce pk sizes with trade-offs.</p>
      </div>
    </div>
  </div>

  <div class="island" id="algorithms">
    <h2>Algorithms</h2>

    <h3>Key generation</h3>
    <p class="muted">
      Choose random affine maps \(S,T\) and construct a central OaV-structured map \(F\). Publish \(P=S\circ F\circ T\) as \(m\)
      quadratic polynomials in \(n\) variables; keep \(S,T,F\) as the secret key (or seeds to regenerate them).
    </p>
    <p class="mono">
      \( \mathrm{pk}=P=\{P_i(x)\}_{i=1}^{m},\qquad \mathrm{sk}=(S,T,F)\ \text{(or seeds)}. \)
    </p>

    <h3>Signing</h3>
    <p class="muted">
      Compute digest \( y=H(M) \in \mathbb{F}_q^{\,o} \). Sample vinegar \( \mathbf{v}\in\mathbb{F}_q^{\,v} \), solve
    </p>
    <p class="mono">\( A(\mathbf{v})\,\mathbf{o}=b(\mathbf{v}) \) </p>
    <p class="muted">
      for \( \mathbf{o} \); if singular or unsolvable, resample \( \mathbf{v} \). Set \( x=T^{-1}(x') \) with \( x'=(\mathbf{v}\,\|\,\mathbf{o}) \),
      and output the signature \( \sigma=x \).
    </p>

    <h3>Verification</h3>
    <p class="muted">
      Recompute \( P(\sigma) \) and accept iff \( P(\sigma)=H(M) \).
    </p>
  </div>

  <div class="island" id="security">
    <h2>Security at a glance</h2>
    <ul class="muted">
      <li><b>Assumption:</b> Hardness of solving multivariate quadratic (MQ) systems over small fields.</li>
      <li><b>Attacks:</b> Rank/Gröbner-basis, direct/linearization, MinRank-style, and differential/structural attacks inform parameter choices.</li>
      <li><b>Design notes:</b> Unbalancing (large \(v\), smaller \(o\)) aims to keep signing efficient while maintaining resistance to algebraic attacks.</li>
      <li><b>Context:</b> UOV descendants (e.g., Rainbow) highlight the need to track evolving cryptanalysis and avoid weak structures.</li>
    </ul>
  </div>

  <div class="island" id="impl">
    <h2>Implementation notes</h2>
    <ul class="muted">
      <li><b>Field/arithmetic:</b> \( \mathbb{F}_{2^8} \) is common; vectorize finite-field ops (e.g., AVX2/NEON) for speed.</li>
      <li><b>Linear algebra:</b> Constant-time Gaussian elimination for \(A(\mathbf{v})\); precompute tables for finite-field mult.</li>
      <li><b>Hashing:</b> Domain-separated hash for \(H(M)\); optional per-signature salt to hedge input collisions.</li>
      <li><b>Compression:</b> Consider seed-expansion or structured pk formats to mitigate very large public keys.</li>
      <li><b>Side-channels:</b> Avoid secret-dependent branching/memory; fix loop bounds; clear temporary buffers.</li>
    </ul>
  </div>

  <div class="island" id="proscons">
    <h2>Pros & cons</h2>
    <div class="grid-2">
      <div>
        <h3>Pros</h3>
        <ul class="muted">
          <li>Fast signing (linear solve) and short signatures (≈\(n\) bytes for \(q{=}256\)).</li>
          <li>Conceptually simple core; purely finite-field operations (good for SIMD/GPU).</li>
          <li>Long research history; tunable parameters for different security/size trade-offs.</li>
        </ul>
      </div>
      <div>
        <h3>Cons</h3>
        <ul class="muted">
          <li>Very large public keys (100s KB–MB) unless using compressed/seeded representations.</li>
          <li>Security highly sensitive to parameters/structure; must track latest cryptanalysis.</li>
          <li>Key generation and verification can be heavy due to \(O(n^2 m)\) public map size.</li>
        </ul>
      </div>
    </div>
  </div>

  <div class="island" id="references">
    <h2>References</h2>
    <ol class="refs muted">
      <li>[1] J. Patarin, “<i>The Oil and Vinegar Signature Scheme</i>,” 1997 (preprint/CT crypt). Introductory OaV concept.</li>
      <li>[2] A. Kipnis, J. Patarin, and L. Goubin, “<i>Unbalanced Oil and Vinegar Signature Schemes</i>,” EUROCRYPT ’99. UOV core design.</li>
      <li>[3] D. J. Bernstein, T. Lange (eds.), “<i>Post-Quantum Cryptography</i>,” multivariate survey chapters (various years). Background & attacks.</li>
      <li>[4] J. Ding and D. Schmidt, “<i>Rainbow, a New Multivariable Polynomial Signature Scheme</i>,” ACNS 2005 (descendant/context).</li>
      <li>[5] Recent cryptanalysis literature on MQ/UOV-style schemes (Gröbner, MinRank, structural). Use to guide parameter selection.</li>
    </ol>
  </div>
</body>
</html>
