<!DOCTYPE html>
<html lang="en">
<head>
  {% from '_background_effects.html' import background_layer, background_rules %}
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>{{ label }} - Details</title>
  <link rel="icon" href="/static/favicon.svg" type="image/svg+xml" sizes="any" />
  <link rel="mask-icon" href="/static/favicon.svg" color="#1fb6b8" />
  <link rel="apple-touch-icon" href="/static/Images/pqc-bench-logo.png" />
  <meta name="theme-color" content="#0b0f14" />
  <style>
    /* Dark scrollbar styling */
    html {
      scrollbar-width: thin;
      scrollbar-color: rgba(36, 49, 63, 0.85) rgba(7, 11, 17, 0.92);
    }
    html::-webkit-scrollbar {
      width: 12px;
      height: 12px;
    }
    html::-webkit-scrollbar-track {
      background: rgba(7, 11, 17, 0.92);
    }
    html::-webkit-scrollbar-thumb {
      background: rgba(148, 163, 184, 0.45);
      border-radius: 999px;
      border: 2px solid rgba(7, 11, 17, 0.92);
    }
    html::-webkit-scrollbar-thumb:hover {
      background: rgba(148, 163, 184, 0.65);
    }

  :root { --island-bg: rgba(38,41,45,.92); --island-radius:1.5rem; --text:#fff; --accent:#1fb6b8; }
    body {
      margin:0;
      padding:5vh 5vw;
      color:var(--text);
      font-family: Inter, system-ui, -apple-system, Segoe UI, Roboto, "Helvetica Neue", Arial, sans-serif;
      background:
        radial-gradient(circle at 15% 20%, rgba(31, 182, 184, 0.16), transparent 55%),
        radial-gradient(circle at 80% 15%, rgba(77, 157, 255, 0.12), transparent 60%),
        linear-gradient(180deg, #070b11 0%, #04070c 60%, #020408 100%);
      position: relative;
    }
    .island { background:var(--island-bg); border-radius:var(--island-radius); padding:1.25rem; backdrop-filter: blur(4px); max-width: 1000px; margin:0 auto 1.6vh auto; }
    .btn, button, input[type="submit"], input[type="button"], a.btn { padding:.65rem 1.4rem; border:none; border-radius:.7rem; background: var(--accent); color:#fff; cursor:pointer; box-shadow: 0 4px 14px rgba(31,182,184,.25); text-decoration:none; transition: background-color .2s ease, filter .15s ease, box-shadow .2s ease; }
    .btn:hover, button:hover, input[type="submit"]:hover, input[type="button"]:hover, a.btn:hover { filter: brightness(0.92); box-shadow: 0 6px 18px rgba(31,182,184,.32); }
    .badge { font-size:.9rem; background:rgba(255,255,255,.2); padding:.2rem .6rem; border-radius:.4rem; display:inline-block; }
    .muted { opacity:.9; }
    h2, h3 { margin: 0 0 .6rem 0; }
    h2 { font-size:1.25rem; }
    h3 { font-size:1.05rem; margin-top:1.2rem; }
    .grid-2 { display:grid; grid-template-columns:1fr 1fr; gap:1rem; }
    .mono { font-family: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono", "Courier New", monospace; }
    table { width:100%; border-collapse:collapse; }
    th, td { text-align:left; padding:.45rem .4rem; border-bottom:1px solid rgba(255,255,255,.2); }
    th { font-weight:600; }
    .refs li { margin:.35rem 0; }
    .chip { display:inline-block; font-size:.85rem; padding:.1rem .5rem; border-radius:.4rem; background:rgba(255,255,255,.15); margin-right:.4rem; }
    .toc a { color:#fff; text-decoration:none; }
    .toc a:hover { text-decoration:underline; }
    .note { font-size:.95rem; opacity:.95; }
    code { background: rgba(255,255,255,.12); padding:.05rem .3rem; border-radius:.3rem; }
    ol.refs { list-style: none; margin: 0; padding-left: 0; }
    {{ background_rules() | safe }}
  </style>
  <!-- MathJax for LaTeX-style math -->
  <script async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
</head>
<body>
  {{ background_layer() }}
<div class="island" style="display:flex; justify-content:space-between; align-items:center; margin-bottom:2vh;">
    <div>
      <div style="font-size:1.6rem; font-weight:700;">{{ label }}</div>
      {% if kind %}<div class="badge" title="Kind">{{ kind }}</div>{% endif %}
    </div>
    <div>
      <a href="/" class="btn">Back to home</a>
    </div>
  </div>

  <div class="island">
    <div style="font-weight:700; margin-bottom:.5rem;">About</div>
    <p class="muted">
      {{ about or 'This page explains the HQC (Hamming Quasi-Cyclic) KEM in depth: its origins, math, parameters, algorithms, security assumptions, and practical considerations—plus references.' }}
    </p>
    <div class="toc muted">
      <span class="chip"><a href="#history">Origins & history</a></span>
      <span class="chip"><a href="#overview">Design overview</a></span>
      <span class="chip"><a href="#math">Mathematical setting</a></span>
      <span class="chip"><a href="#params">Parameter sets</a></span>
      <span class="chip"><a href="#algorithms">Algorithms</a></span>
      <span class="chip"><a href="#security">Security</a></span>
      <span class="chip"><a href="#impl">Implementation notes</a></span>
      <span class="chip"><a href="#proscons">Pros & cons</a></span>
      <span class="chip"><a href="#references">References</a></span>
    </div>
  </div>

  <div class="island" id="history">
    <h2>Origins & history</h2>
    <p class="muted">
      <strong>HQC</strong> is a code-based KEM whose security is grounded in the <em>Quasi-Cyclic Syndrome Decoding</em> (QCSD) problem. It originates from the “Efficient Encryption from Random Quasi-Cyclic Codes” line of work (HQC/RQC) and evolved through the NIST PQC process. In <strong>March 2025</strong>, NIST selected HQC as the fifth PQC algorithm (a <em>backup KEM</em> to ML-KEM/Kyber) and moved it toward standardisation, citing its distinct code-based foundation. HQC continues to be maintained by the original team with regularly updated specifications and proofs. [1][2][3][4]
    </p>
  </div>

  <div class="island" id="overview">
    <h2>Design overview</h2>
    <p class="muted">
      HQC first defines a compact, IND-CPA public-key encryption (HQC-PKE) built on random double-circulant codes, then applies a salted Fujisaki–Okamoto transform in the HHK framework with implicit rejection to obtain an IND-CCA2 KEM (HQC-KEM). Messages are encoded with a concatenated Reed-Muller/Reed-Solomon code (RMRS) to obtain strong decoding guarantees and a tightly controlled decryption-failure rate (DFR). [1][3]
    </p>
  </div>

  <div class="island" id="math">
    <h2>Mathematical setting</h2>
    <p class="muted">
      Work in the binary vector space \(V=\mathbb{F}_2^n\), identified with the ring \(R=\mathbb{F}_2[X]/(X^n-1)\). Convolution (polynomial) multiplication of \(u,v\in V\) is
    </p>
    <p class="mono">
      \( w_k \;=\; \sum_{i+j\equiv k\ (\mathrm{mod}\ n)} u_i\,v_j,\quad k=0,\dots,n-1. \)
    </p>
    <p class="muted">
      For a vector \(v\), let \(\mathrm{rot}(v)\) be its circulant matrix. The public matrix has double-circulant form \(H=(I_n\;|\;\mathrm{rot}(h))\). The ambient length \(n\) is chosen as the smallest primitive prime greater than \(n_1n_2\) (the length of the concatenated RMRS code), and computations sometimes truncate the last \(\ell = n - n_1n_2\) bits. [1]
    </p>
    <h3>Security problems</h3>
    <p class="muted">
      IND-CPA security of HQC-PKE reduces to decisional QCSD variants with parity/truncation:
      \( \text{Adv}^{\mathrm{IND\mbox{-}CPA}}_{\text{HQC-PKE}} \le
      \text{Adv}_{\text{2-DQCSD-P}} + \text{Adv}_{\text{3-DQCSD-PT}}. \)  [1]
    </p>
  </div>

  <div class="island" id="params">
    <h2>Parameter sets (HQC-1/3/5)</h2>
    <p class="muted note">Each set uses a concatenated RMRS code of length \(n_1n_2\), dimension \(k\), and targets DFR below the security level. Weights \( \omega \) (secret), \( \omega_r \) (ephemeral), and \( \omega_e \) (error) are fixed per level.</p>
    <div class="grid-2">
      <div>
        <table>
          <thead><tr><th>Instance</th><th>Level</th><th>\(n_1\)</th><th>\(n_2\)</th><th>\(n\)</th><th>\(k\)</th><th>\(\omega\)</th><th>\(\omega_r=\omega_e\)</th><th>DFR</th></tr></thead>
          <tbody>
            <tr><td>HQC-1</td><td>NIST-1</td><td>46</td><td>384</td><td>17 669</td><td>128</td><td>66</td><td>75</td><td>\(&lt;2^{-128}\)</td></tr>
            <tr><td>HQC-3</td><td>NIST-3</td><td>56</td><td>640</td><td>35 851</td><td>192</td><td>100</td><td>114</td><td>\(&lt;2^{-192}\)</td></tr>
            <tr><td>HQC-5</td><td>NIST-5</td><td>90</td><td>640</td><td>57 637</td><td>256</td><td>131</td><td>149</td><td>\(&lt;2^{-256}\)</td></tr>
          </tbody>
        </table>
      </div>
      <div class="muted">
        <h3>Sizes (bytes)</h3>
        <table>
          <thead><tr><th>Instance</th><th>\(|\mathrm{ek}_{\mathrm{KEM}}|\)</th><th>\(|\mathrm{dk}_{\mathrm{KEM}}|\)</th><th>\(|c_{\mathrm{KEM}}|\)</th><th>\(|K|\)</th></tr></thead>
          <tbody>
            <tr><td>HQC-1</td><td>2241</td><td>2321</td><td>4433</td><td>32</td></tr>
            <tr><td>HQC-3</td><td>4514</td><td>4602</td><td>8978</td><td>32</td></tr>
            <tr><td>HQC-5</td><td>7237</td><td>7333</td><td>14 421</td><td>32</td></tr>
          </tbody>
        </table>
        <p class="muted" style="margin-top:.5rem;">Seeds and salt are 32 B and 16 B respectively. [1]</p>
      </div>
    </div>
  </div>

  <div class="island" id="algorithms">
    <h2>Algorithms</h2>

    <h3>HQC-PKE.Keygen</h3>
    <p class="muted">
      From a seed, derive decryption-key seed and encryption-key seed; sample fixed-weight \(y,x\in\mathbb{F}_2^n\) (weight \(\omega\)). Sample \(h\in\mathbb{F}_2^n\) uniformly (via XOF from the ek-seed). Set
    </p>
    <p class="mono">
      \( s \;=\; x \;+\; h\cdot y \in \mathbb{F}_2^n, \quad \mathrm{ek}_{\mathrm{PKE}}=(\text{seed}_{\mathrm{ek}}, s), \quad \mathrm{dk}_{\mathrm{PKE}}=\text{seed}_{\mathrm{dk}}. \)  [1]
    </p>

    <h3>HQC-PKE.Encrypt</h3>
    <p class="muted">
      Parse \(h\) from \(\text{seed}_{\mathrm{ek}}\). Sample fixed-weight \(r_2, e, r_1\) (weights \(\omega_r,\omega_e,\omega_r\)). Compute:
    </p>
    <p class="mono">
      \( u \;=\; r_1 \;+\; h\cdot r_2, \qquad v \;=\; C.\mathrm{Encode}(m)\;+\;\mathrm{Truncate}(s\cdot r_2 + e,\,\ell), \)
    </p>
    <p class="muted">
      and output \( c_{\mathrm{PKE}}=(u,v) \). Here \(C\) is the concatenated RMRS code; \(\ell=n-n_1n_2\). [1]
    </p>

    <h3>HQC-PKE.Decrypt</h3>
    <p class="muted">
      Reconstruct \(y\) from \(\text{seed}_{\mathrm{dk}}\) and decode:
    </p>
    <p class="mono">
      \( m \;=\; C.\mathrm{Decode}\big(v - \mathrm{Truncate}(u\cdot y,\,\ell)\big). \)  [1]
    </p>

    <h3>HQC-KEM (salted FO with implicit rejection)</h3>
    <p class="muted">
      KEM keys reuse the PKE keys with extra randomness \(\sigma\). Encapsulation samples a random \(m\) and salt, derives \((K,\theta)=G(H(\mathrm{ek}_{\mathrm{KEM}})\,\|\,m\,\|\,\text{salt})\), sets \(c_{\mathrm{PKE}}=\mathrm{Encrypt}(\mathrm{ek}_{\mathrm{KEM}},m,\theta)\), and outputs \(c_{\mathrm{KEM}}=(c_{\mathrm{PKE}},\text{salt})\). Decapsulation recovers \(m'\), recomputes \((K',\theta')\), and checks by re-encrypting; on failure it returns a rejection key \( \bar K = J(H(\mathrm{ek}_{\mathrm{KEM}})\,\|\,\sigma\,\|\,c_{\mathrm{KEM}}) \) (“implicit rejection”). [1]
    </p>
  </div>

  <div class="island" id="security">
    <h2>Security at a glance</h2>
    <ul class="muted">
      <li><b>Assumption:</b> QCSD on random quasi-cyclic (double-circulant) codes; IND-CPA reduces to 2-DQCSD-P and 3-DQCSD-PT. [1]</li>
      <li><b>IND-CCA2:</b> Salted FO/HHK with implicit rejection; proof in ROM (δ-correct PKE ⇒ δ-correct KEM). [1]</li>
      <li><b>DFR targets:</b> \(&lt;2^{-128}\), \(&lt;2^{-192}\), \(&lt;2^{-256}\)\) for HQC-1/3/5 respectively. [1]</li>
      <li><b>Status:</b> Selected by NIST (Mar 2025) as a backup KEM to ML-KEM; draft standardisation underway. [2]</li>
    </ul>
  </div>

  <div class="island" id="impl">
    <h2>Implementation notes</h2>
    <ul class="muted">
      <li><b>Symmetric choices:</b> XOF = SHAKE-256; \(G,I=\) SHA3-512; \(H,J=\) SHA3-256 (domain-separated). [1]</li>
      <li><b>Arithmetic:</b> Binary polynomials mod \(X^n-1\); vector multiplies use Toom–Cook + Karatsuba; secrets/errors are fixed-weight. [1]</li>
      <li><b>RMRS decoding:</b> Concatenated RM (e.g., \([128,8,64]\) duplicated) with Reed–Solomon outer; decoding/DFR analysis provided in spec. [1][4]</li>
      <li><b>Constant-time:</b> Reference and optimised (e.g., AVX2) implementations aim to be constant-time; sampling order tuned for hardware. [1]</li>
    </ul>
  </div>

  <div class="island" id="proscons">
    <h2>Pros & cons</h2>
    <div class="grid-2">
      <div>
        <h3>Pros</h3>
        <ul class="muted">
          <li>Different math from lattices (defense-in-depth vs ML-KEM); clear DFR bounds. [1][2]</li>
          <li>Simple binary arithmetic and fast bit-sliced implementations.</li>
          <li>No need to hide a structured code family; uses random double-circulant structure. [1]</li>
        </ul>
      </div>
      <div>
        <h3>Cons</h3>
        <ul class="muted">
          <li>Keys/ciphertexts larger than ML-KEM at similar NIST levels. [1]</li>
          <li>PKE encryption rate is relatively low for very large plaintexts (use KEM+AEAD). [1]</li>
        </ul>
      </div>
    </div>
  </div>

  <div class="island" id="references">
    <h2>References</h2>
    <ol class="refs muted">
      <li>[1] P. Gaborit <i>et&nbsp;al.</i>, “<i>Hamming Quasi-Cyclic (HQC) — Specifications</i>,” ver. 2025-08-22. [Online]. Available: <a href="https://pqc-hqc.org/doc/hqc_specifications_2025_08_22.pdf" target="_blank" rel="noopener">pqc-hqc.org</a></li>
      <li>[2] NIST, “NIST Selects HQC as Fifth Algorithm for Post-Quantum Encryption,” News Release, Mar. 11, 2025. [Online]. Available: <a href="https://www.nist.gov/news-events/news/2025/03/nist-selects-hqc-fifth-algorithm-post-quantum-encryption" target="_blank" rel="noopener">nist.gov</a></li>
      <li>[3] NIST CSRC Seminar, “Hamming Quasi-Cyclic (HQC) — Overview & HHK Transform,” Sep. 20, 2024. [Online]. Available: <a href="https://csrc.nist.gov/projects/post-quantum-cryptography/pqc-seminars" target="_blank" rel="noopener">csrc.nist.gov</a></li>
      <li>[4] C. Aguilar-Melchor, O. Blazy, J.-C. Deneuville, P. Gaborit, and G. Zémor, “Efficient Encryption from Random Quasi-Cyclic Codes,” <i>IEEE Trans. Inf. Theory</i>, 64(5), pp. 3927–3943, 2018. [Online]. Available: <a href="https://deneuville.github.io/files/HQC_RQC_IEEE_IT.pdf" target="_blank" rel="noopener">deneuville.github.io</a></li>
      <li>[5] Open Quantum Safe, “HQC (Parameter Set Summary),” accessed Sep. 2025. [Online]. Available: <a href="https://openquantumsafe.org/liboqs/algorithms/kem/hqc.html" target="_blank" rel="noopener">openquantumsafe.org</a></li>
    </ol>
  </div>
</body>
</html>

